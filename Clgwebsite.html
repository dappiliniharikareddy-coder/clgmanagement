<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Result Management System</title>
    <style>
    </style>
    <script>
        function openTab(tabName) {
            var tabs = document.getElementsByClassName("tab");
            for (var i = 0; i < tabs.length; i++) {
                tabs[i].style.display = "none";
            }
            document.getElementById(tabName).style.display = "block";
        }

        function showUploadButton() {
            document.getElementById('uploadButton').style.display = 'block';
        }
    </script>
    <link rel="stylesheet" href="styles.css">

</head>

<body>
    <div style="text-align:left;background-color: #E7E8D1;margin-top: 10px;">
        <img src="https://siiet.ac.in/wp-content/uploads/2023/05/main-new-logo.png" alt="Logo"
            style="height: 90px;margin-left: 30px;">
        <img src="https://sriindu.ac.in/wp-content/uploads/2019/05/certificates-logos.png" alt="Logo"
            style="height: 90px;margin-right: 30px;">
    </div>

    <hr size="2px" color="black">
    <div class="navbar">
        <a href="#" onclick="openTab('Home')">Home</a>
        <a href="#" onclick="openTab('studentTab')">Student Login</a>
        <a href="#" onclick="openTab('adminTab')">Admin Login</a>
    </div>

    <div id="Home" class="tab" style="display: block;">
        <link rel="stylesheet" href="Home.css">
        <br><br>
        <div style="display: flex;">
            <div style="flex: 1; margin-right: 20px;margin-left: 20px;border: 3px solid black;">
                <h3 style="font-family: 'Times New Roman', Times, serif; font-size: 25px; text-align: center;">Sri Indu
                    College</h3>
                <hr style="border-color: black;">
                <img src="https://shiksha-static-mediadata.s3.ap-southeast-1.amazonaws.com/mediadata/reviewDocument/images/1688066626258images.jpeg"
                    style="max-width:500px;padding: 10px;margin-top: 10px;">
            </div>

            <div style="flex: 1;border: 3px solid black;margin-left: 20px;margin-right: 20px;">
                <h3 style="font-family: 'Times New Roman', Times, serif; font-size: 25px; text-align: center;">UPDATES
                </h3>
                <hr style="border-color: black;">
                <div
                    style="border: 3px solid black; padding: 5px; margin: 20px; height: 300px; display: flex; flex-direction: column-reverse; background-color: #ffffff;">
                    <marquee id="adminMarquee" behavior="scroll" direction="up" scrolldelay="450"
                        style="flex:1;margin-bottom: 0;margin-top: 0px;font-family: 'Times New Roman', Times, serif;font-size: 20px;font-weight: bold;">
                    </marquee>
                </div>
            </div>

            <div style="flex: 1; border: 3px solid black;margin-right: 20px;">
                <h3 style="font-family: 'Times New Roman', Times, serif; font-size: 25px; text-align: center;">Results
                    Management System</h3>
                <hr style="border-color: black;">
                <p
                    style="font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif; font-size: 18px; padding-left: 10px;">
                    By providing online access to grades and records, it enhances communication between
                    students,parents, and faculty, fostering collaboration and student success.<br> <br>
                    Overall, this systems modernize education, promoting efficiency and transparency while
                    empowering stakeholders to make informed
                    decisions for better outcomes.
                </p>
            </div>

            <script>
                function displayMarqueeText() {
                    var existingMarqueeTexts = JSON.parse(localStorage.getItem("marqueeTexts")) || [];
                    var marqueeElement = document.getElementById("adminMarquee");
                    var marqueeContent = existingMarqueeTexts.map(text => '<span>' + text + '</span>').join('');
                    marqueeElement.innerHTML = marqueeContent;
                }

                displayMarqueeText();
            </script>
        </div>



    </div>
    </div>

    <div id="adminTab" class="tab" style="display: none;">
        <link rel="stylesheet" href="adminlogin.css">
        <section>
            <form method="post" onsubmit="return validateAdminLogin()">
                <div class="form-box">
                    <div class="form-value">
                        <h2 style="color: black;">Admin Login</h2>
                        <div class="inputbox">
                            <ion-icon name="mail-outline"></ion-icon>
                            <input type="text" id="adminUsername" name="adminUsername" required="">
                            <label for="">Username</label>
                        </div>
                        <div class="inputbox">
                            <ion-icon name="lock-closed-outline"></ion-icon>
                            <input type="password" id="adminPassword" name="adminPassword" required="">
                            <label for="">Password</label>
                        </div>
                        <button>Log in</button>
                    </div>
                </div>
            </form>
        </section>
        <script src='https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js'></script>
        <script src='https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js'></script>
    </div>

    <script>
        function validateAdminLogin() {
            const adminUsername = document.getElementById('adminUsername').value;
            const adminPassword = document.getElementById('adminPassword').value;

            if (adminUsername === 'admin@sriindu' && adminPassword === 'results') {
                window.location.href = 'admin.html';
                return false;
            } else {
                alert('Error: Invalid username or password.');
                return false;
            }
        }
    </script>


    <div id="studentTab" class="tab" style="display: none;">
        <link rel="stylesheet" href="Studentlogin.css">
        <section>
            <form>
                <div class="form-box">
                    <div class="form-value">
                        <h2 style="color: black;">Student Login</h2>
                        <div class="inputbox">
                            <ion-icon name="mail-outline"></ion-icon>
                            <input type="text" id="username" required="">
                            <label for="">Username</label>
                        </div>
                        <div class="inputbox">
                            <ion-icon name="lock-closed-outline"></ion-icon>
                            <input type="password" id="password"  required="">
                            <label for="">Password</label>
                        </div>
                        <button onclick="attemptLogin()">Login</button>
                    </div>
                </div>
            </form>
        </section>
        <div id="output"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>
    <script>
        function attemptLogin() {
            const usernameInput = document.getElementById('username');
            const passwordInput = document.getElementById('password');
            const outputDiv = document.getElementById('output');

            fetch('LOGIN.xlsx')
                .then(response => response.arrayBuffer())
                .then(buffer => {
                    const data = new Uint8Array(buffer);
                    const workbook = XLSX.read(data, { type: 'array' });

                    const sheetName = workbook.SheetNames[0];
                    const sheet = workbook.Sheets[sheetName];

                    const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
                    const enteredUsername = usernameInput.value;
                    const enteredPassword = passwordInput.value;
                    const matchingUser = jsonData.find(user => user[0] === enteredUsername && user[1] === enteredPassword);

                    if (matchingUser) {
                        sessionStorage.setItem('loggedInUsername', enteredUsername);
                        window.location.href = 'student.html';
                    } else {
                        outputDiv.innerHTML = 'Error: Invalid username or password.';
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    outputDiv.innerHTML = 'Error: Unable to read user credentials from Excel.';
                });
        }
    </script>
</body>

</html>